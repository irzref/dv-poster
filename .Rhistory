require(AER)
install.packages("AER")
require(AER)
install.packages("rio")
install.packages("curl")
install.packages("libcurl")
install.packages("curl")
install.packages("AER")
install.packages("AER")
install.packages("rio",dep=TRUE)
install.packages("AER")
require(AER)
data(CPS1985)
install.packages("AER",dep=TRUE)
install.packages("rgl")
require(rgl)
install.packages(c("maps", "mapdata"))
devtools::install_github("dkahle/ggmap")
install.packages("devtools")
devtools::install_github("dkahle/ggmap")
library(ggplot2)
library(ggmap)
library(maps)
library(mapdata)
indonesia <- map_data("indonesia")
indonesia <- map_data("usa")
indonesia <- map_data("china")
indonesia <- map_data("indonesia")
indonesia <- map_data("malaysia")
?map_data
indonesia <- map_data("australia")
indonesia <- map_data("singapore")
library("rgdal")
install.packages("rgdal")
install.packages("rgdal")
install.packages("rgdal")
install.packages("rgdal")
install.packages("rgdal"); library(rgdal)
setwd("/home/irza/Projects/dv-poster")
library("ggplot2")
library("rgdal")
exprt_origin <- read.csv("asalprovinsiekspor.csv")
exprt_destination <- read.csv("eksporperikanannasional.csv")
# remove the national data, get only data for each province
all_commodities <- exprt_origin[exprt_origin$ProvinsiID!=0 & exprt_origin$KomoditiID==0,]
# aggregate the sum for each province througout the years
all_commodities_by_province <- aggregate(all_commodities$Volume, by=list(Region=all_commodities$Wilayah,Province=all_commodities$NamaProvinsi),FUN=sum)
# load the manually edited all_commodities_by_province !!!
all_commodities_by_province_edited <- read.csv("all_commodities_by_province.csv")
all_commodities$NamaProvinsiNew <- all_commodities$NamaProvinsi
all_commodities$NamaProvinsiNew[all_commodities$NamaProvinsiNew=='Kepulauan Riau'] <- 'Riau'
all_commodities_by_year_province <- aggregate(all_commodities$Volume, by=list(Year=all_commodities$Tahun,Province=all_commodities$NamaProvinsi),FUN=sum)
all_commodities_by_year_province$Part <- with(all_commodities_by_province_edited, Part[match(all_commodities_by_year_province$Province, Province)])
colnames(all_commodities_by_year_province)[3] <- "Volume"
all_commodities_by_year_part <- aggregate(all_commodities_by_year_province$Volume, by=list(Year=all_commodities_by_year_province$Year,Part=all_commodities_by_year_province$Part),FUN=sum)
colnames(all_commodities_by_year_part)[3] <- "Volume"
plotting_commodity_df <-
all_commodities_by_year_part %>%
mutate(Volume = if_else(Part == "WEST", -Volume, Volume))
library(dplyr)
plotting_commodity_df <-
all_commodities_by_year_part %>%
mutate(Volume = if_else(Part == "WEST", -Volume, Volume))
the_commodity_order <- plotting_commodity_df$Year[plotting_commodity_df$Part=="WEST"]
p <-
plotting_commodity_df %>%
ggplot(aes(x = Year, y = Volume, group = Part, fill = Part)) +
geom_bar(stat = "identity", width = 0.75) +
coord_flip() +
scale_x_discrete(limits = the_commodity_order) +
# another trick!
scale_y_continuous(breaks = seq(-4e+05, 3e+05, 1e+05),
labels = abs(seq(-4e+05, 3e+05, 1e+05))) +
labs(x = "Year", y = "Volume", title = "Export Volume by Export Origin") +
theme(legend.position = "bottom",
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill =  "grey90")) +
# reverse the order of items in legend
# guides(fill = guide_legend(reverse = TRUE)) +
# change the default colors of bars
scale_fill_manual(values=c("red", "blue"),
name="",
breaks=c("WEST", "EAST"),
labels=c("WESTERN", "CENTRAL and EASTERN"))
p
p <-
plotting_commodity_df %>%
ggplot(aes(x = Year, y = Volume, group = Part, fill = Part)) +
geom_bar(stat = "identity", width = 0.75) +
coord_flip() +
scale_x_discrete(limits = the_commodity_order) +
# another trick!
scale_y_continuous(breaks = seq(-4e+05, 3e+05, 1e+05),
labels = abs(seq(-4e+05, 3e+05, 1e+05))) +
labs(x = "Year", y = "Volume", title = "Export Volume by Export Origin") +
theme(legend.position = "bottom",
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill =  "grey90")) +
# reverse the order of items in legend
# guides(fill = guide_legend(reverse = TRUE)) +
# change the default colors of bars
scale_fill_manual(values=c("red", "blue"),
name="",
breaks=c("WEST", "EAST"),
labels=c("WESTERN", "CENTRAL and EASTERN")) +
theme(legend.margin=margin(t = 3, unit='cm'))
p
?margin
p <-
plotting_commodity_df %>%
ggplot(aes(x = Year, y = Volume, group = Part, fill = Part)) +
geom_bar(stat = "identity", width = 0.75) +
coord_flip() +
scale_x_discrete(limits = the_commodity_order) +
# another trick!
scale_y_continuous(breaks = seq(-4e+05, 3e+05, 1e+05),
labels = abs(seq(-4e+05, 3e+05, 1e+05))) +
labs(x = "Year", y = "Volume", title = "Export Volume by Export Origin") +
theme(legend.position = "bottom",
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill =  "grey90")) +
# reverse the order of items in legend
# guides(fill = guide_legend(reverse = TRUE)) +
# change the default colors of bars
scale_fill_manual(values=c("red", "blue"),
name="",
breaks=c("WEST", "EAST"),
labels=c("WESTERN", "CENTRAL and EASTERN")) +
theme(legend.margin=margin(r = 0.5, unit='cm'))
p
p <-
plotting_commodity_df %>%
ggplot(aes(x = Year, y = Volume, group = Part, fill = Part)) +
geom_bar(stat = "identity", width = 0.75) +
coord_flip() +
scale_x_discrete(limits = the_commodity_order) +
# another trick!
scale_y_continuous(breaks = seq(-4e+05, 3e+05, 1e+05),
labels = abs(seq(-4e+05, 3e+05, 1e+05))) +
labs(x = "Year", y = "Volume", title = "Export Volume by Export Origin") +
theme(legend.position = "bottom",
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill =  "grey90")) +
# reverse the order of items in legend
# guides(fill = guide_legend(reverse = TRUE)) +
# change the default colors of bars
scale_fill_manual(values=c("red", "blue"),
name="",
breaks=c("WEST", "EAST"),
labels=c("WESTERN", "CENTRAL and EASTERN")) +
theme(legend.margin=margin(r = 3, unit='cm'))
p
?theme
?element_text
p <-
plotting_commodity_df %>%
ggplot(aes(x = Year, y = Volume, group = Part, fill = Part)) +
geom_bar(stat = "identity", width = 0.75) +
coord_flip() +
scale_x_discrete(limits = the_commodity_order) +
# another trick!
scale_y_continuous(breaks = seq(-4e+05, 3e+05, 1e+05),
labels = abs(seq(-4e+05, 3e+05, 1e+05))) +
labs(x = "Year", y = "Volume", title = "Export Volume by Export Origin") +
theme(legend.position = "bottom",
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill =  "grey90")) +
# reverse the order of items in legend
# guides(fill = guide_legend(reverse = TRUE)) +
# change the default colors of bars
scale_fill_manual(values=c("red", "blue"),
name="",
breaks=c("WEST", "EAST"),
labels=c("WESTERN", "CENTRAL and EASTERN")) +
theme(legend.text = element_text(hjust = 3))
p
p <-
plotting_commodity_df %>%
ggplot(aes(x = Year, y = Volume, group = Part, fill = Part)) +
geom_bar(stat = "identity", width = 0.75) +
coord_flip() +
scale_x_discrete(limits = the_commodity_order) +
# another trick!
scale_y_continuous(breaks = seq(-4e+05, 3e+05, 1e+05),
labels = abs(seq(-4e+05, 3e+05, 1e+05))) +
labs(x = "Year", y = "Volume", title = "Export Volume by Export Origin") +
theme(legend.position = "bottom",
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill =  "grey90")) +
# reverse the order of items in legend
# guides(fill = guide_legend(reverse = TRUE)) +
# change the default colors of bars
scale_fill_manual(values=c("red", "blue"),
name="",
breaks=c("WEST", "EAST"),
labels=c("WESTERN", "CENTRAL and EASTERN")) +
theme(legend.text = element_text(hjust = 7))
p
?theme
p <-
plotting_commodity_df %>%
ggplot(aes(x = Year, y = Volume, group = Part, fill = Part)) +
geom_bar(stat = "identity", width = 0.75) +
coord_flip() +
scale_x_discrete(limits = the_commodity_order) +
# another trick!
scale_y_continuous(breaks = seq(-4e+05, 3e+05, 1e+05),
labels = abs(seq(-4e+05, 3e+05, 1e+05))) +
labs(x = "Year", y = "Volume", title = "Export Volume by Export Origin") +
theme(legend.position = "bottom",
legend.title = element_blank(),
plot.title = element_text(hjust = 0.5),
panel.background = element_rect(fill =  "grey90")) +
# reverse the order of items in legend
# guides(fill = guide_legend(reverse = TRUE)) +
# change the default colors of bars
scale_fill_manual(values=c("red", "blue"),
name="",
breaks=c("WEST", "EAST"),
labels=c("WESTERN", "CENTRAL and EASTERN")) +
theme(legend.text = element_text(margin = margin(r=3)))
p
View(exprt_destination)
table(exprt_destination$Negara, exprt_destination$NamaKomoditi)
# export destination
unique(exprt_destination[c("NamaKomoditi", "KomoditiID")])
View(exprt_destination[exprt_destination$KomoditiID==0,])
View(exprt_destination[exprt_destination$KomoditiID==0 & exprt_destination$NegaraID!=31,])
# diagram 3
# comparison of sum volume of  each commodity aggregated by commodity, top 10 country (stacked barchart) !!!
exprt_destination_country <- exprt_destination[exprt_destination$NegaraID!=31,]
exprt_destination_by_country_commodity <- aggregate(exprt_destination_country$Volume, by=list(Country=exprt_destination_country$Negara,Commodity=exprt_destination_country$NamaKomoditi),FUN=sum)
View(exprt_destination_by_country_commodity)
exprt_destination_by_country_commodity <- aggregate(exprt_destination_country$Volume, by=list(Commodity=exprt_destination_country$NamaKomoditi,Country=exprt_destination_country$Negara),FUN=sum)
View(exprt_destination_by_country_commodity)
DF <- read.table(text="Rank F1     F2     F3
1    500    250    50
2    400    100    30
3    300    155    100
4    200    90     10", header=TRUE)
library(reshape2)
DF1 <- melt(DF, id.var="Rank")
DF1
ggplot(DF1, aes(x = Rank, y = value, fill = variable)) +
geom_bar(stat = "identity")
View(exprt_destination_by_country_commodity)
colnames(exprt_destination_by_country_commodity)[3]
colnames(exprt_destination_by_country_commodity)[3] <- "Volume"
ggplot(exprt_destination_by_country_commodity, aes(x = Country, y = Volume, fill = Commodity)) +
geom_bar(stat = "identity")
exprt_destination_by_country_all_commodity <- exprt_destination_by_country_commodity[exprt_destination_by_country_commodity$Commodity=="semua komoditi - all commodities",]
View(exprt_destination_by_country_all_commodity)
order(exprt_destination_by_country_all_commodity$Commodity)
exprt_destination_by_country_all_commodity[order(exprt_destination_by_country_all_commodity$Commodity),]
exprt_destination_by_country_all_commodity[order(exprt_destination_by_country_all_commodity$Volume),]
exprt_destination_by_country_all_commodity[order(exprt_destination_by_country_all_commodity$Volume, decreasing = FALSE),]
exprt_destination_by_country_all_commodity <- exprt_destination_by_country_all_commodity[order(exprt_destination_by_country_all_commodity$Volume, decreasing = TRUE),]
exprt_destination_by_country_top_5 <- exprt_destination_by_country_all_commodity[,1:8]
View(exprt_destination_by_country_top_5)
exprt_destination_by_country_top_5 <- exprt_destination_by_country_all_commodity[1:8,]
View(exprt_destination_by_country_top_5)
exprt_destination_by_country_top_8 <- exprt_destination_by_country_all_commodity[1:8,]
View(exprt_destination_by_country_top_8)
exprt_destination_by_country_top_8_commodity <- exprt_destination_by_country_commodity[is.element(exprt_destination_by_country_commodity$Country, exprt_destination_by_country_top_8$Country),]
View(exprt_destination_by_country_top_8_commodity)
exprt_destination_by_country_top_8_commodity <- exprt_destination_by_country_top_8_commodity[exprt_destination_by_country_top_8_commodity$Commodity!="semua komoditi - all commodities",]
ggplot(exprt_destination_by_country_top_8_commodity, aes(x = Country, y = Volume, fill = Commodity)) +
geom_bar(stat = "identity")
order(exprt_destination_by_country_all_commodity$Volume, decreasing = TRUE)
exprt_destination_by_country_top_8_commodity$Total <- with(exprt_destination_by_country_top_8, Volume[match(exprt_destination_by_country_top_8_commodity$Country, Country)])
View(exprt_destination_by_country_top_8_commodity[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE),])
ggplot(exprt_destination_by_country_top_8_commodity[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE),], aes(x = Country, y = Volume, fill = Commodity)) +
geom_bar(stat = "identity")
factor(exprt_destination_by_country_top_8_commodity$Country)
exprt_destination_by_country_top_8_commodity_ordered <- exprt_destination_by_country_top_8_commodity[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE),]
exprt_destination_by_country_top_8_commodity_ordered$Country
factor(exprt_destination_by_country_top_8_commodity$Country, levels = exprt_destination_by_country_top_8_commodity_ordered$Country)
factor(exprt_destination_by_country_top_8_commodity$Country, levels = exprt_destination_by_country_top_8_commodity$Country[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE),])
exprt_destination_by_country_top_8_commodity$Country[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE),]
exprt_destination_by_country_top_8_commodity$Country
dim(exprt_destination_by_country_top_8_commodity$Country)
dim(exprt_destination_by_country_top_8_commodity$Country)
length(exprt_destination_by_country_top_8_commodity$Country)
dim(order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE))
length(order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE))
exprt_destination_by_country_top_8_commodity$Country[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE)]
factor(exprt_destination_by_country_top_8_commodity$Country, levels = exprt_destination_by_country_top_8_commodity$Country[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE)])
factor(exprt_destination_by_country_top_8_commodity$Country)
factor(exprt_destination_by_country_top_8_commodity$Country, levels = unique(exprt_destination_by_country_top_8_commodity$Country[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE)]))
unique(exprt_destination_by_country_top_8_commodity$Country[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE)])
factor(exprt_destination_by_country_top_8_commodity$Country, levels = unique(exprt_destination_by_country_top_8_commodity$Country[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE)]))
factor(exprt_destination_by_country_top_8_commodity_ordered$Country)
ggplot(exprt_destination_by_country_top_8_commodity[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE),], aes(x = exprt_destination_by_country_top_8_commodity_ordered$Country, y = Volume, fill = Commodity)) +
geom_bar(stat = "identity")
factor(exprt_destination_by_country_top_8_commodity_ordered$Country)
ggplot(exprt_destination_by_country_top_8_commodity[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE),], aes(x = factor(exprt_destination_by_country_top_8_commodity_ordered$Country), y = Volume, fill = Commodity)) +
geom_bar(stat = "identity")
reorder(exprt_destination_by_country_top_8_commodity$Country, exprt_destination_by_country_top_8_commodity$Total)
exprt_destination_by_country_top_8_commodity$Country
ggplot(exprt_destination_by_country_top_8_commodity_ordered, aes(x = factor(exprt_destination_by_country_top_8_commodity_ordered$Country), y = Volume, fill = Commodity)) +
geom_bar(stat = "identity")
ggplot(exprt_destination_by_country_top_8_commodity_ordered, aes(x = Country, y = Volume, fill = Commodity)) +
geom_bar(stat = "identity")
?reorder
exprt_destination_by_country_top_8_commodity$Team3 <- reorder(exprt_destination_by_country_top_8_commodity$Country, exprt_destination_by_country_top_8_commodity$Total)
exprt_destination_by_country_top_8_commodity
View(exprt_destination_by_country_top_8_commodity_ordered)
reorder(exprt_destination_by_country_top_8_commodity$Country, exprt_destination_by_country_top_8_commodity$Total)
unique(exprt_destination_by_country_top_8_commodity$Country[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE)])
factor(exprt_destination_by_country_top_8_commodity$Country, levels = unique(exprt_destination_by_country_top_8_commodity$Country[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE)]))
exprt_destination_by_country_top_8_commodity$Country <- factor(exprt_destination_by_country_top_8_commodity$Country, levels = unique(exprt_destination_by_country_top_8_commodity$Country[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE)]))
ggplot(exprt_destination_by_country_top_8_commodity[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE),], aes(x = Country, y = Volume, fill = Commodity)) +
geom_bar(stat = "identity")
ggplot(exprt_destination_by_country_top_8_commodity, aes(x = Country, y = Volume, fill = Commodity)) +
geom_bar(stat = "identity")
View(exprt_destination)
ggplot(exprt_destination_by_country_top_8_commodity, aes(x = Country, y = Volume, fill = Commodity)) +
geom_bar(stat = "identity") +
labs(title = "Top 8 Export Destinations by Export Volume 2001 - 2012")
ggplot(exprt_destination_by_country_top_8_commodity, aes(x = Country, y = Volume, fill = Commodity)) +
geom_bar(stat = "identity") +
labs(title = "Top 8 Export Destinations by Export Volume 2001 - 2012") +
theme(plot.title = element_text(hjust = 0.5))
exprt_destination_by_country_top_8_commodity$Country[exprt_destination_by_country_top_8_commodity$Country=="Cina"]
exprt_destination_by_country_top_8_commodity$Country[exprt_destination_by_country_top_8_commodity$Country=="Cina"] <- "China"
exprt_destination_by_country_top_8_commodity <- exprt_destination_by_country_commodity[is.element(exprt_destination_by_country_commodity$Country, exprt_destination_by_country_top_8$Country),]
exprt_destination_by_country_top_8_commodity <- exprt_destination_by_country_top_8_commodity[exprt_destination_by_country_top_8_commodity$Commodity!="semua komoditi - all commodities",]
exprt_destination_by_country_top_8_commodity$Country[exprt_destination_by_country_top_8_commodity$Country=="Cina"] <- "China"
ggplot(exprt_destination_by_country_top_8_commodity, aes(x = Country, y = Volume, fill = Commodity)) +
geom_bar(stat = "identity") +
labs(title = "Top 8 Export Destinations by Export Volume 2001 - 2012") +
theme(plot.title = element_text(hjust = 0.5))
exprt_destination_by_country_top_8_commodity
exprt_destination <- read.csv("eksporperikanannasional.csv")
# remove the "other country"
exprt_destination_country <- exprt_destination[exprt_destination$NegaraID!=31,]
exprt_destination_by_country_commodity <- aggregate(exprt_destination_country$Volume, by=list(Commodity=exprt_destination_country$NamaKomoditi,Country=exprt_destination_country$Negara),FUN=sum)
colnames(exprt_destination_by_country_commodity)[3] <- "Volume"
# order the country by volume
exprt_destination_by_country_all_commodity <- exprt_destination_by_country_commodity[exprt_destination_by_country_commodity$Commodity=="semua komoditi - all commodities",]
exprt_destination_by_country_all_commodity <- exprt_destination_by_country_all_commodity[order(exprt_destination_by_country_all_commodity$Volume, decreasing = TRUE),]
View(exprt_destination_by_country_all_commodity)
# take top 8
exprt_destination_by_country_top_8 <- exprt_destination_by_country_all_commodity[1:8,]
exprt_destination_by_country_top_8_commodity <- exprt_destination_by_country_commodity[is.element(exprt_destination_by_country_commodity$Country, exprt_destination_by_country_top_8$Country),]
exprt_destination_by_country_top_8_commodity <- exprt_destination_by_country_top_8_commodity[exprt_destination_by_country_top_8_commodity$Commodity!="semua komoditi - all commodities",]
View(exprt_destination_by_country_top_8_commodity)
exprt_destination_by_country_top_8_commodity[exprt_destination_by_country_top_8_commodity$Country=="Cina"] <- "China"
exprt_destination_by_country_top_8_commodity[exprt_destination_by_country_top_8_commodity$Country=="Cina","Country"]
exprt_destination_by_country_top_8_commodity[exprt_destination_by_country_top_8_commodity$Country=="Cina","Country"] <- "China"
exprt_destination_by_country_top_8_commodity$CountryEng[exprt_destination_by_country_top_8_commodity$Country=="Cina"] <- "China"
exprt_destination_by_country_top_8_commodity$CountryEng[exprt_destination_by_country_top_8_commodity$Country=="Cina"]
exprt_destination_by_country_top_8_commodity
View(exprt_destination_by_country_top_8_commodity)
exprt_destination_by_country_top_8_commodity <- exprt_destination_by_country_commodity[is.element(exprt_destination_by_country_commodity$Country, exprt_destination_by_country_top_8$Country),]
exprt_destination_by_country_top_8_commodity <- exprt_destination_by_country_top_8_commodity[exprt_destination_by_country_top_8_commodity$Commodity!="semua komoditi - all commodities",]
View(exprt_destination_by_country_top_8_commodity)
exprt_destination_by_country_top_8_commodity$CountryEng[exprt_destination_by_country_top_8_commodity$Country=="Cina"] <- "China"
exprt_destination_by_country_top_8_commodity$CountryEng[exprt_destination_by_country_top_8_commodity$Country=="Amerika Serikat"] <- "USA"
exprt_destination_by_country_top_8_commodity$CountryEng[exprt_destination_by_country_top_8_commodity$Country=="Cina"] <- "China"
exprt_destination_by_country_top_8_commodity$CountryEng[exprt_destination_by_country_top_8_commodity$Country=="Amerika Serikat"] <- "USA"
exprt_destination_by_country_top_8_commodity$CountryEng[exprt_destination_by_country_top_8_commodity$Country=="Hongkong"] <- "Hongkong"
exprt_destination_by_country_top_8_commodity$CountryEng[exprt_destination_by_country_top_8_commodity$Country=="Jepang"] <- "Jepan"
exprt_destination_by_country_top_8_commodity$CountryEng[exprt_destination_by_country_top_8_commodity$Country=="Malaysia"] <- "Malaysia"
exprt_destination_by_country_top_8_commodity$CountryEng[exprt_destination_by_country_top_8_commodity$Country=="Singapura"] <- "Singapore"
exprt_destination_by_country_top_8_commodity$CountryEng[exprt_destination_by_country_top_8_commodity$Country=="Taiwan"] <- "Taiwan"
exprt_destination_by_country_top_8_commodity$CountryEng[exprt_destination_by_country_top_8_commodity$Country=="Thailand"] <- "Thailand"
# set the order
exprt_destination_by_country_top_8_commodity$Total <- with(exprt_destination_by_country_top_8, Volume[match(exprt_destination_by_country_top_8_commodity$Country, Country)])
exprt_destination_by_country_top_8_commodity_ordered <- exprt_destination_by_country_top_8_commodity[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE),]
View(exprt_destination_by_country_top_8_commodity_ordered)
exprt_destination_by_country_top_8_commodity_ordered <- exprt_destination_by_country_top_8_commodity[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE),]
View(exprt_destination_by_country_top_8_commodity_ordered)
exprt_destination_by_country_top_8_commodity$CountryEng <- factor(exprt_destination_by_country_top_8_commodity$CountryEng, levels = unique(exprt_destination_by_country_top_8_commodity$CountryEng[order(exprt_destination_by_country_top_8_commodity$Total, decreasing = TRUE)]))
ggplot(exprt_destination_by_country_top_8_commodity, aes(x = CountryEng, y = Volume, fill = Commodity)) +
geom_bar(stat = "identity") +
labs(x = "Country", title = "Top 8 Export Destinations by Export Volume 2001 - 2012") +
theme(plot.title = element_text(hjust = 0.5))
